!function(i){COTimeline=function(i,t){this.node=t,this.timeline=this.node.find(".ets-co-timeline"),this.items=this.node.find(".ets-co-timeline-vertical .ets-co-timeline-item"),this.connector_wrap=this.node.find(".ets-co-timeline-vertical .ets-co-timeline-connector-wrap"),this.connector=this.node.find(".ets-co-timeline-vertical .ets-co-timeline-connector"),this.progressBar=this.node.find(".ets-co-timeline-vertical .ets-co-timeline-connector-inner"),this.iconClass=this.node.find(".ets-co-timeline-vertical .ets-co-timeline-icon-wrapper"),void 0!==i.window&&(this.window=i.window),this.init()},COTimeline.prototype={node:"",items:"",connector:"",progressBar:"",window:i(window),winHeight:0,scrollTop:0,lastWinHeight:-1,lastScrollTop:-1,isScrolling:!1,isResizing:!1,isAnimating:!1,animationClass:"bounce-in",init:function(){"vertical"==this.timeline.data("timeline-layout")&&(this.winHeight=i(window).height(),this.scrollTop=this.window.scrollTop(),this.bindEvents(),this.requestAnimation(),this.revealItems())},bindEvents:function(){this.window.on("scroll",i.proxy(function(){this.scrollTop=this.window.scrollTop(),this.requestAnimation(),this.revealItems()},this)),i(window).on("resize",i.proxy(function(){this.scrollTop=this.window.scrollTop(),this.winHeight=i(window).height(),this.requestAnimation()},this))},requestAnimation:function(){if(!this.isAnimating)requestAnimationFrame(this.reboot.bind(this));this.isAnimating=!0},revealItems:function(){var t=this;this.items.each(function(){i(this).offset().top<=t.window.scrollTop()+.95*i(window).outerHeight()&&i(this).hasClass("ets-co-timeline-item-hidden")&&i(this).removeClass("ets-co-timeline-item-hidden").addClass(t.animationClass)})},setup:function(){this.connector_wrap.css("left",this.iconClass.eq(0)[0].offsetLeft+this.iconClass.eq(0).width()/2-this.connector_wrap.width()/2),this.connector.css({top:this.items.first().find(this.iconClass).offset().top-this.items.first().offset().top,bottom:this.node.offset().top+this.node.outerHeight()-this.items.last().find(this.iconClass).offset().top})},reboot:function(){this.isAnimating=!1,this.winHeight!==this.lastWinHeight&&this.setup(),this.start.bind(this)()},start:function(){this.scrollTop===this.lastScrollTop&&this.winHeight===this.lastWinHeight||(this.lastScrollTop=this.scrollTop,this.lastWinHeight=this.winHeight,this.progress())},progress:function(){var t=this,s=i(window);this.items.each(function(){i(this).find(t.iconClass).offset().top<t.window.scrollTop()+s.outerHeight()/2?i(this).addClass("ets-co-timeline-item-active"):i(this).removeClass("ets-co-timeline-item-active")});var e=this.node.find(".ets-co-timeline-connector").height()+this.items.first().find(this.iconClass).offset().top,o=this.window.scrollTop()-this.progressBar.offset().top+s.outerHeight()/2;e<=this.window.scrollTop()+s.outerHeight()/2&&(o=e-this.progressBar.offset().top),this.progressBar.css("height",o+"px")}}}(jQuery);