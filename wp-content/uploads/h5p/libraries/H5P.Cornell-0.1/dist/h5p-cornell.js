(()=>{"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}const t=function(){function t(){}return t.extend=function(){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&("object"===e(arguments[0][n])&&"object"===e(arguments[t][n])?this.extend(arguments[0][n],arguments[t][n]):arguments[0][n]=arguments[t][n]);return arguments[0]},t.htmlDecode=function(e){var t=(new DOMParser).parseFromString(e,"text/html");return t.documentElement?t.documentElement.textContent:""},t.stripHTML=function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},t.formatLanguageCode=function(e){if("string"!=typeof e)return e;var t=e.split("-");return t[0]=t[0].toLowerCase(),t.length>1&&(t[1]=t[1].toUpperCase()),e=t.join("-")},t}();var n=function(){function e(e,n){var i=this;this.params=t.extend({a11y:{active:"",disabled:"",inactive:""},active:!1,classes:[],disabled:!1,type:"pulse"},e||{}),Array.isArray(this.params.classes)||(this.params.classes=[this.params.classes]),"pulse"===this.params.type&&(this.params.a11y.inactive||(this.params.a11y.inactive=this.params.a11y.active||""),this.params.a11y.active||(this.params.a11y.active=this.params.a11y.inactive||"")),this.active=this.params.active,this.disabled=this.params.disabled,this.callbacks=n||{},this.callbacks.onClick=this.callbacks.onClick||function(){},this.button=document.createElement("button"),this.params.classes&&this.params.classes.forEach((function(e){i.button.classList.add(e)})),this.button.setAttribute("aria-pressed",this.params.active),this.button.setAttribute("tabindex","0"),!0===this.params.active?this.activate():this.deactivate(),!0===this.params.disabled?this.disable():this.enable(),this.button.addEventListener("click",(function(e){i.disabled||("toggle"===i.params.type&&i.toggle(),i.callbacks.onClick(e))}))}var n=e.prototype;return n.getDOM=function(){return this.button},n.show=function(){this.button.classList.remove("h5p-cornell-display-none")},n.hide=function(){this.button.classList.add("h5p-cornell-display-none")},n.enable=function(){this.disabled=!1,this.button.classList.remove("h5p-cornell-button-disabled"),this.active?this.activate():this.deactivate()},n.disable=function(){this.button.classList.add("h5p-cornell-button-disabled"),this.button.setAttribute("aria-label",this.params.a11y.disabled),this.button.setAttribute("title",this.params.a11y.disabled),this.disabled=!0},n.activate=function(){this.disabled||("toggle"===this.params.type&&(this.button.classList.add("h5p-cornell-button-active"),this.button.setAttribute("aria-pressed",!0)),this.button.setAttribute("aria-label",this.params.a11y.active),this.button.setAttribute("title",this.params.a11y.active),this.active=!0)},n.deactivate=function(){this.disabled||(this.active=!1,"toggle"===this.params.type&&(this.button.classList.remove("h5p-cornell-button-active"),this.button.setAttribute("aria-pressed",!1)),this.button.setAttribute("aria-label",this.params.a11y.inactive),this.button.setAttribute("title",this.params.a11y.inactive))},n.toggle=function(e){this.disabled||((e="boolean"==typeof e?e:!this.active)?this.activate():this.deactivate())},n.isActive=function(){return this.active},n.isDisabled=function(){return this.disabled},e}(),i=function(){function e(e,i){var s=this;this.params=t.extend({title:"",dateString:(new Date).toLocaleDateString(),toggleButtonActiveOnStartup:!0,a11y:{buttonToggleActive:"toggle",buttonToggleInactive:"toggle"}},e||{}),this.callbacks=t.extend({handleButtonToggle:function(){},handleButtonFullscreen:function(){}},i||{}),this.titleBar=document.createElement("div"),this.titleBar.classList.add("h5p-cornell-title-bar");!0===this.params.toggleButtonActiveOnStartup&&["h5p-cornell-button","h5p-cornell-button-toggle"].push("h5p-cornell-active"),this.buttonToggle=new n({type:"toggle",classes:["h5p-cornell-button","h5p-cornell-button-toggle"],a11y:{active:this.params.a11y.buttonToggleActive,inactive:this.params.a11y.buttonToggleInactive}},{onClick:function(){s.callbacks.handleButtonToggle()}});var a=document.createElement("div");a.classList.add("h5p-cornell-title"),a.innerHTML=this.params.title;var r=document.createElement("div");r.classList.add("h5p-cornell-date"),r.innerHTML=this.params.dateString,this.buttonFullscreen=new n({type:"toggle",classes:["h5p-cornell-button","h5p-cornell-button-fullscreen"],disabled:!0,a11y:{active:this.params.a11y.buttonFullscreenExit,inactive:this.params.a11y.buttonFullscreenEnter}},{onClick:function(){s.callbacks.handleButtonFullscreen()}}),this.titleBar.appendChild(this.buttonToggle.getDOM()),this.titleBar.appendChild(a),this.titleBar.appendChild(r),this.titleBar.appendChild(this.buttonFullscreen.getDOM())}var i=e.prototype;return i.getDOM=function(){return this.titleBar},i.getToggleButtonState=function(){return this.buttonToggle.isActive()},i.enableFullscreenButton=function(){this.buttonFullscreen.enable()},i.toggleFullscreenButton=function(e){"string"==typeof e&&("enter"===e?e=!1:"exit"===e&&(e=!0)),"boolean"==typeof e&&this.buttonFullscreen.toggle(e)},e}(),s=function(){function e(e,n,i,s){this.params=e,this.contentId=n,this.extras=i,this.previousState=t.extend({dateString:(new Date).toLocaleDateString(),recall:{inputField:""},mainNotes:{inputField:""},summary:{inputField:""}},i.previousState||{}),this.callbacks=s||{},this.callbacks.handleButtonFullscreen=s.handleButtonFullscreen||function(){},this.isExerciseMode=!this.params.behaviour.showNotesOnStartup,this.content=document.createElement("div"),this.content.classList.add("h5p-cornell-container"),this.titlebar=this.createTitleBar(),this.content.appendChild(this.titlebar.getDOM());var a=document.createElement("div");a.classList.add("h5p-cornell-panel"),this.exerciseWrapper=this.createExerciseDOM(),a.appendChild(this.exerciseWrapper),this.notesWrapper=this.createNotesDOM(),a.appendChild(this.notesWrapper),this.content.appendChild(a)}var n=e.prototype;return n.getDOM=function(){return this.content},n.createTitleBar=function(){var e=this;return new i({title:this.extras.metadata.title,dateString:this.previousState.dateString,toggleButtonActiveOnStartup:this.params.behaviour.showNotesOnStartup,a11y:{buttonToggleActive:this.params.a11y.buttonToggleCloseNotes,buttonToggleInactive:this.params.a11y.buttonToggleOpenNotes,buttonFullscreenEnter:this.params.a11y.buttonFullscreenEnter,buttonFullscreenExit:this.params.a11y.buttonFullscreenExit}},{handleButtonToggle:function(t){return e.handleButtonToggle(t)},handleButtonFullscreen:this.callbacks.handleButtonFullscreen})},n.createExerciseDOM=function(){var e=this,t=document.createElement("div");t.classList.add("h5p-cornell-exercise-wrapper"),this.isExerciseMode||t.classList.add("h5p-cornell-notes-mode");var n=document.createElement("div");n.classList.add("h5p-cornell-exercise-content");var i=document.createElement("div");i.classList.add("h5p-cornell-exercise-content-library");var s=document.createElement("div");s.classList.add("h5p-cornell-exercise-content-wrapper"),s.appendChild(n),t.appendChild(s),t.addEventListener("transitionend",(function(){e.isExerciseMode||(0===t.offsetWidth&&t.classList.add("h5p-cornell-display-none"),setTimeout((function(){e.resize()}),0))})),this.params.exerciseContent&&this.params.exerciseContent.library&&(this.exerciseMachineName=this.params.exerciseContent.library.split(" ")[0]);var a=!0;if(void 0!==this.exerciseMachineName){switch(this.exerciseMachineName){case"H5P.Audio":this.params.exerciseContent.params.controls=!0,this.params.exerciseContent.params.fitToWrapper=!0,this.params.exerciseContent.params.playerMode="full";break;case"H5P.Video":this.params.exerciseContent.params.visuals.controls=!0,this.params.exerciseContent.params.visuals.fit=!1}switch(this.exercise=H5P.newRunnable(this.params.exerciseContent,this.contentId,H5P.jQuery(i),!1,{previousState:this.previousState.exercise}),this.exerciseMachineName){case"H5P.Audio":this.exercise.audio&&(this.exercise.audio.style.height=""),a=!1;break;case"H5P.Video":this.exercise.on("stateChange",(function(t){e.mediumRunning=1===t.data})),a=!1,this.exercise.on("resize",(function(){if(void 0===e.youtubeWrapper){var t=document.querySelector(".h5p-cornell-exercise-content-library.h5p-video.h5p-youtube");e.youtubeWrapper=t?t.firstChild:null}e.resize(!0)}))}n.appendChild(this.createInstructionsDOM()),a&&n.appendChild(this.createSeparatorDOM()),n.appendChild(i)}else{var r=document.createElement("div");r.innerHTML="No content was chosen for this exercise",i.appendChild(r)}return t},n.createNotesDOM=function(){var e=this,t=document.createElement("div");t.classList.add("h5p-cornell-notes-wrapper"),this.isExerciseMode?t.classList.add("h5p-cornell-display-none"):t.classList.add("h5p-cornell-notes-mode"),t.addEventListener("transitionend",(function(){e.isExerciseMode&&t.classList.add("h5p-cornell-display-none"),setTimeout((function(){e.resize()}),0)}));var n=document.createElement("div");return n.classList.add("h5p-cornell-notes-content-wrapper"),t.appendChild(n),n.appendChild(this.createMainNotesDOM()),n.appendChild(this.createSummaryDOM()),t},n.createInstructionsDOM=function(){var e=document.createElement("div");return""!==this.params.instructions&&(e.classList.add("h5p-cornell-instructions-wrapper"),e.innerHTML=this.params.instructions),e},n.createSeparatorDOM=function(){var e=document.createElement("div");return e.classList.add("h5p-cornell-content-separator"),e},n.createMainNotesDOM=function(){var e=document.createElement("div");e.classList.add("h5p-cornell-main-notes-wrapper");var n=document.createElement("div");n.classList.add("h5p-cornell-main-notes-recall-wrapper"),this.recall=H5P.newRunnable({params:{taskDescription:this.params.notesFields.recallTitle,placeholderText:t.htmlDecode(this.params.notesFields.recallPlaceholder),inputFieldSize:this.params.fieldSizeNotes},library:"H5P.TextInputField 1.2",subContentId:H5P.createUUID()},this.contentId,H5P.jQuery(n),!1,{previousState:this.previousState.recall}),e.appendChild(n);var i=document.createElement("div");return i.classList.add("h5p-cornell-main-notes-notes-wrapper"),this.mainNotes=H5P.newRunnable({params:{taskDescription:this.params.notesFields.notesTitle,placeholderText:t.htmlDecode(this.params.notesFields.notesPlaceholder),inputFieldSize:this.params.fieldSizeNotes},library:"H5P.TextInputField 1.2",subContentId:H5P.createUUID()},this.contentId,H5P.jQuery(i),!1,{previousState:this.previousState.mainNotes}),e.appendChild(i),e},n.createSummaryDOM=function(){var e=document.createElement("div");return e.classList.add("h5p-cornell-summary-wrapper"),this.summary=H5P.newRunnable({params:{taskDescription:this.params.notesFields.summaryTitle,placeholderText:t.htmlDecode(this.params.notesFields.summaryPlaceholder),inputFieldSize:this.params.fieldSizeNotes},library:"H5P.TextInputField 1.2",subContentId:H5P.createUUID()},this.contentId,H5P.jQuery(e),!1,{previousState:this.previousState.summary}),e},n.resize=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.exercise&&!t&&(this.youtubeWrapper&&(this.youtubeWrapper.style.width="100%"),setTimeout((function(){e.exercise.trigger("resize")}),0)),this.content.offsetWidth<this.params.minWidthForDualView?this.isNarrowScreen||(this.isNarrowScreen=!0,this.exerciseWrapper.classList.add("h5p-cornell-narrow-screen"),this.isExerciseMode||this.toggleMedium()):(this.exerciseWrapper.classList.remove("h5p-cornell-display-none"),setTimeout((function(){e.exerciseWrapper.classList.remove("h5p-cornell-narrow-screen")}),0),this.isNarrowScreen&&(this.isNarrowScreen=!1,this.isExerciseMode||this.toggleMedium())),"function"==typeof this.callbacks.resize&&this.callbacks.resize()},n.enableFullscreenButton=function(){this.titlebar.enableFullscreenButton()},n.toggleFullscreen=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.titlebar.toggleFullscreenButton(t),!0===t?setTimeout((function(){var t="".concat(window.innerHeight-e.titlebar.getDOM().offsetHeight,"px");e.exerciseWrapper.style.maxHeight=t,e.notesWrapper.style.maxHeight=t}),100):(this.exerciseWrapper.style.maxHeight="",this.notesWrapper.style.maxHeight="",setTimeout((function(){e.resize()}),0))},n.handleButtonToggle=function(e){if(!e||"keypress"!==e.type||13===e.keyCode||32===e.keyCode){var n=this.titlebar.getToggleButtonState();if("function"==typeof this.callbacks.read){var i=n?this.params.a11y.notesOpened:this.params.a11y.notesClosed;this.callbacks.read(t.stripHTML(i))}this.toggleView(),this.isNarrowScreen&&this.toggleMedium()}},n.toggleView=function(){var e=this;this.exerciseWrapper.classList.remove("h5p-cornell-display-none"),this.notesWrapper.classList.remove("h5p-cornell-display-none"),setTimeout((function(){e.exerciseWrapper.classList.toggle("h5p-cornell-notes-mode"),e.notesWrapper.classList.toggle("h5p-cornell-notes-mode"),e.isExerciseMode=!e.isExerciseMode,e.resize()}),0)},n.toggleMedium=function(){var e,t;switch(this.exerciseMachineName){case"H5P.Video":e=this.exercise,t=this.mediumRunning}e&&(t?(this.continueMedia=t,e.pause&&e.pause()):!0===this.continueMedia&&(this.continueMedia=void 0,e.play&&e.play()))},n.stripTags=function(e){return e.inputField=t.htmlDecode(e.inputField),e},n.getAnswerGiven=function(){return this.recall.getInput().value.length+this.mainNotes.getInput().value.length+this.summary.getInput().value.length>0},n.resetNotes=function(){this.recall.setState({}),this.mainNotes.setState({}),this.summary.setState({})},n.getCurrentState=function(){return{dateString:this.previousState.dateString,recall:this.stripTags(this.recall.getCurrentState()),mainNotes:this.stripTags(this.mainNotes.getCurrentState()),summary:this.stripTags(this.summary.getCurrentState()),exercise:this.exercise&&this.exercise.getCurrentState?this.exercise.getCurrentState():void 0}},e}();function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}s.MODE_EXERCISE=0,s.MODE_NOTES=1;var o=function(e){var n,i;function o(n,i){var r,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(var c in(r=e.call(this,"cornell")||this).contentId=i,n.behaviour={showNotesOnStartup:!0===n.behaviour},r.params=t.extend({instructions:"",fieldSizeNotes:10,fieldSizeSummary:7,notesFields:{recallTitle:"Recall",recallPlaceholder:"Enter your keywords, questions, the main idea, etc.",notesTitle:"Notes",notesPlaceholder:"Enter dates, details, definitions, formulas, examples, etc.",summaryTitle:"Summary",summaryPlaceholder:"Enter your summary"},behaviour:{enableSolutionsButton:!1,enableRetry:!1},l10n:{submitAnswer:"Submit"},a11y:{buttonFullscreenEnter:"Enter fullscreen mode",buttonFullscreenExit:"Exit fullscreen mode",buttonToggleOpenNotes:"Switch to the notes",buttonToggleCloseNotes:"Switch to the exercise",notesOpened:"The view switched to your notes.",notesClosed:"The view switched to the exercise."},minWidthForDualView:o.MIN_WIDTH_FOR_DUALVIEW},n),r.params.a11y)r.params.a11y[c]=t.htmlDecode(r.params.a11y[c]);r.extras=t.extend({metadata:{title:"Cornell Notes"},previousState:o.getPreviousStateLocal(r.contentId)||{}},l);var u=r.extras.metadata.defaultLanguage||"en";return r.languageTag=t.formatLanguageCode(u),r.handleDocumentComplete=function(){setTimeout((function(){r.container=document.querySelector(".h5p-container"),r.container&&(r.content.enableFullscreenButton(),r.on("enterFullScreen",(function(){r.content.toggleFullscreen(!0)})),r.on("exitFullScreen",(function(){r.content.toggleFullscreen(!1)}))),r.content.resize()}),0)},"complete"===document.readyState?r.handleDocumentComplete():document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&r.handleDocumentComplete()})),r.registerDomElements=function(){r.params.behaviour.showNotesOnStartup=r.params.behaviour.showNotesOnStartup&&document.querySelector(".h5p-container").offsetWidth>=o.MIN_WIDTH_FOR_DUALVIEW,r.content=new s(r.params,r.contentId,r.extras,{resize:r.resize,read:r.read,handleButtonFullscreen:r.toggleFullscreen}),r.setContent(r.content.getDOM())},r.toggleFullscreen=function(e){r.container&&("string"==typeof e&&("enter"===e?e=!1:"exit"===e&&(e=!0)),"boolean"!=typeof e&&(e=!H5P.isFullscreen),!0===e?H5P.fullScreen(H5P.jQuery(r.container),a(r)):H5P.exitFullScreen())},r.getAnswerGiven=function(){return r.content.getAnswerGiven()},r.getScore=function(){return 0},r.getMaxScore=function(){return 0},r.showSolutions=function(){},r.resetTask=function(){r.content.resetNotes()},r.on("resize",(function(e){e.data&&!0===e.data.break||r.content.resize()})),r.resize=function(){r.trigger("resize",{break:!0})},r.getXAPIData=function(){return{statement:r.getXAPIAnswerEvent().data.statement}},r.getXAPIAnswerEvent=function(){var e=r.createXAPIEvent("answered");return e.setScoredResult(r.getScore(),r.getMaxScore(),a(r),!0,r.isPassed()),e},r.createXAPIEvent=function(e){var n=r.createXAPIEventTemplate(e);return t.extend(n.getVerifiedStatementValue(["object","definition"]),r.getxAPIDefinition()),n},r.getxAPIDefinition=function(){var e={name:{}};return e.name[r.languageTag]=r.getTitle(),e.name["en-US"]=e.name[r.languageTag],e.description={},e.description[r.languageTag]=r.getDescription(),e.description["en-US"]=e.description[r.languageTag],e.type="http://adlnet.gov/expapi/activities/cmi.interaction",e.interactionType="long-fill-in",e},r.isPassed=function(){return!0},r.getTitle=function(){var e;return r.extras.metadata&&(e=r.extras.metadata.title),e=e||o.DEFAULT_DESCRIPTION,H5P.createTitle(e)},r.getDescription=function(){return r.params.taskDescription||o.DEFAULT_DESCRIPTION},r.getCurrentState=function(){var e=r.content.getCurrentState();try{window.localStorage&&window.localStorage.setItem("".concat(o.DEFAULT_DESCRIPTION,"-").concat(r.contentId),JSON.stringify(e))}catch(e){}return e},r}return i=e,(n=o).prototype=Object.create(i.prototype),n.prototype.constructor=n,r(n,i),o.getPreviousStateLocal=function(e){try{if(!window.localStorage||"number"!=typeof e)return null}catch(e){return null}var t=window.localStorage.getItem("".concat(o.DEFAULT_DESCRIPTION,"-").concat(e));if(t)try{t=JSON.parse(t)}catch(e){t=null}return t},o}(H5P.Question);o.DEFAULT_DESCRIPTION="Cornell Notes",o.MIN_WIDTH_FOR_DUALVIEW=1024,H5P=H5P||{},H5P.Cornell=o})();